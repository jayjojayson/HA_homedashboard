title: Solar
path: solar
icon: mdi:home-lightning-bolt-outline
type: sections
sections:
  - type: grid
    cards:
      - type: heading
        heading: Solar/Aktueller Verbrauch
        heading_style: title
      - type: custom:vertical-stack-in-card
        card_mod:
          style: |
            ha-card {
              box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                          13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
              border: none;   
              background: none;
            }
        cards:
          - type: custom:stack-in-card
            cards:
              - type: horizontal-stack
                card_mod:
                  style: |
                    :host {
                      background-color: transparent !important;
                      border: none !important;
                    }
                cards:
                  - type: energy-self-sufficiency-gauge
                    card_mod:
                      style: |
                        ha-card {
                          width: 80% !important;
                          margin: 0 auto;
                          background-color: transparent !important;
                          border: 0px !important;
                          border-radius: 0px !important;
                          --line-color: {{ states('sensor.solar_line_color') }};
                        }
                        ha-svg-icon {
                          visibility: hidden; 
                        }
                  - type: energy-solar-consumed-gauge
                    card_mod:
                      style: |
                        ha-card {
                          width: 80% !important;
                          margin: 0 auto;
                          background-color: transparent !important;
                          border: none !important;
                          border-radius: 0px !important;
                          --line-color: {{ states('sensor.solar_line_color') }};
                        }
                        ha-svg-icon {
                          visibility: hidden; 
                        }
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.erzeugzung_taglich_kombination_solaranlagen
                name: Ertrag
                show_state: false
            name: Ertrag Heute
            hours_to_show: 72
            points_per_hour: 0.25
            height: 80
            show:
              labels: true
              name: false
              state: false
              icon: false
            color_thresholds:
              - value: 1
                color: grey
              - value: 2
                color: orange
              - value: 6
                color: yellow
              - value: 10
                color: green
              - value: 14
                color: blue
            card_mod:
              style: |
                ha-card {
                  margin-top: 1px;
                  border: none !important;
                  border-radius: 0px !important;
                  --line-color: {{ states('sensor.solar_line_color') }};
                }
          - type: custom:button-card
            styles:
              card:
                - background-color: rgba(22,22,22, 0.4)
                - text-align: center
                - border: none
                - border-radius: 0px
                - padding: 10px
                - "--primary-text-color": |
                    [[[
                      if (states['sensor.solar_color'].state === 'grey') return 'grey';
                      if (states['sensor.solar_color'].state === 'darkyellow') return 'darkyellow';
                      if (states['sensor.solar_color'].state === 'yellow') return 'yellow';
                      if (states['sensor.solar_color'].state === 'darkgreen') return 'darkgreen';
                      return 'green';
                    ]]]
            name: |
              [[[
                const solarTotal = states['sensor.erzeugzung_taglich_kombination_solaranlagen'].state;
                return `Solarertrag heute: ${solarTotal} kWh`;
              ]]]
          - type: entities
            entities:
              - entity: sensor.growatt_todaygenerateenergy_euro
                type: custom:multiple-entity-row
                name: Ertrag Heute €
                state_color: true
                hide_unavailable: true
                entities:
                  - entity: sensor.energy_production_today_3
                    name: " "
                    styles:
                      margin-top: 2px
                      margin-right: 20px
                      text-align: right
                      color: "#676767"
                      font-size: 13px
                  - entity: sensor.energy_production_tomorrow_3
                    name: " "
                    styles:
                      margin-top: 2px
                      margin-right: 20px
                      text-align: right
                      color: "#676767"
                      font-size: 13px
              - entity: sensor.growatt_totalgenerateenergy
                name: Ertrag Gesamt kWh
              - entity: sensor.growatt_totalgenerateenergy_euro
                name: Ertrag Gesamt €
                unit_of_measurement: €
                icon: mdi:counter
              - entity: sensor.solar_netzeinspeisung_kwh
                name: Solar Netzeinspeisung Gesamt
              - entity: sensor.stromverbrauch_gesamt_kwh
                name: Stromverbrauch Gesamt
            theme: grey-icon
          - type: custom:bar-card
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  border-radius: 0px !important;
                }               
                bar-card-backgroundbar { 
                  border-radius: 3px !important;  
                }
                bar-card-currentbar {
                  border-radius: 3px !important;  
                }
            name: Aktueller Strombedarf
            positions:
              name: inside
              value: inside
              indicator: "off"
              icon: "off"
            unit_of_measurement: W
            max: 2500
            height: 25px
            severity:
              - color: "#7bc13c"
                from: 0
                to: 50
              - color: "#c1bb3c"
                from: 50
                to: 340
              - color: orange
                from: 340
                to: 500
              - color: darkorange
                from: 500
                to: 1000
              - color: "#ff0000"
                from: 1000
                to: 50000
            entities:
              - entity: sensor.total_power_nur_verbrauch
          - type: custom:stack-in-card
            cards:
              - type: horizontal-stack
                cards:
                  - type: custom:bubble-card
                    name: Hausspeicher
                    card_type: button
                    button_type: state
                    entity: sensor.victron_system_battery_soc
                    tap_action:
                      action: navigate
                      navigation_path: "#batterie"
                    modules:
                      - progress_bar
                    progress_bar:
                      progress_color: red
                      min_value: 0
                      max_value: 100
                      conditional_colors:
                        condition_color_1: orange
                        condition_color_2: green
                        condition_1:
                          - condition: numeric_state
                            entity_id: sensor.victron_system_battery_soc
                            below: 55
                        condition_2:
                          - condition: numeric_state
                            entity_id: sensor.victron_system_battery_soc
                            above: 55
                    sub_button:
                      - entity: sensor.batterie_vr_endladezeit
                        show_icon: false
                        show_name: false
                        show_state: true
                        state_background: false
                        show_background: false
                      - entity: sensor.victron_system_battery_power
                        show_state: true
                        show_icon: false
                        state_background: false
                        show_background: false
                        name: ""
                        show_name: true
                      - entity: sensor.victron_system_battery_voltage
                        show_icon: false
                        show_name: false
                        show_state: true
                        state_background: false
                        show_background: false
                    styles: |
                      .bubble-button-card-container {
                        background: linear-gradient(to right, darkorange 15%, orange 25%, yellow 50%, green 100%);
                        /* opacity: 0.5 !important; */
                        clip-path: inset(0 calc(100% - var(--bar-percent)) 0 0);
                        border-radius: 10px !important;   
                        border-radius: 3px !important;    
                      }
                      .bubble-name-container { 
                        color: #3a3a3a !important;
                      }
                      .bubble-sub-button-name-container { 
                        color: #3a3a3a !important;
                      }
                      .bubble-action-enabled { 
                        border-radius: 3px !important;
                        margin: 0 5px 0 0 !important;
                      }
                      .bubble-button-background { 
                        /* background: linear-gradient(to right, var(--orange-color), #cd101000); */
                      }
                      .bubble-state {
                        font-size: 14px;
                        font-weight: bold;
                        opacity: 1;
                      }
                      .bubble-icon {
                        color: #3a3a3a !important;
                      }
                      .type-custom-bubble-card{
                        margin: 0px 16px 0px 16px !important;
                      }
                    rows: "0.75"
          - type: custom:auto-entities
            card_mod:
              style: |
                ha-card {
                  background-color: transparent !important;
                  border: none !important;
                  border-radius: 0px !important;
                }
            card:
              type: custom:bar-card
              card_mod:
                style: |
                  ha-card {
                    border: none !important;
                    border-radius: 0px !important;
                  }               
                  bar-card-backgroundbar { 
                    border-radius: 3px !important;  
                  }
                  bar-card-currentbar {
                    border-radius: 3px !important;  
                  }
              positions:
                name: inside
                value: inside
                indicator: "off"
                icon: "off"
              unit_of_measurement: W
              max: 1000
              severity:
                - color: "#7bc13c"
                  from: 0
                  to: 65
                - color: "#c1bb3c"
                  from: 65
                  to: 200
                - color: orange
                  from: 200
                  to: 500
                - color: darkorange
                  from: 500
                  to: 1400
                - color: "#ff0000"
                  from: 1400
                  to: 50000
              height: 20px
              decimals: 2
              style: |
                #states { padding: 0 } 
                bar-card-name, bar-card-value {
                  color: #ffffff;
                }
                bar-card-value {
                  font-weight: bold;
                }
                bar-card-indicator {
                  transform: scaleY(-1);
                }
              stack: vertical
              direction: right
            filter:
              include:
                - entity_id: sensor.innenlufter_shellyplug_switch_0_power
                - entity_id: sensor.growlampe_leistung
                - entity_id: sensor.wasserlauf_leistung
                - entity_id: sensor.stromungspumpen_leistung
                - entity_id: sensor.hauptpumpe_shelly_plug_switch_0_power
                - entity_id: sensor.skimmerpumpe_shelly_plug_switch_0_power
                - entity_id: sensor.poollicht_leistung
                - entity_id: sensor.werkstattheizung_leistung
                - entity_id: sensor.waschmaschine_leistung_2
                - entity_id: sensor.trockner_leistung_3
                - entity_id: sensor.3d_drucker_leistung
                - entity_id: sensor.herdlicht_rechts_leistung
                - entity_id: sensor.herdlicht_links_leistung
                - entity_id: sensor.sockelleisten_leistung
                - entity_id: sensor.weihnachtslicht_leistung
                - entity_id: sensor.lavalampe_leistung
                - entity_id: sensor.computer_leistung
                - entity_id: sensor.fernseher_plug_leistung
                - entity_id: sensor.fernseher_mutti_leistung_3
                - entity_id: sensor.fernseher_plug_mutti_schlafzimmer_leistung
                - entity_id: sensor.tablet_plug_leistung
              exclude:
                - state: < 2
                - state: unavailable
            sort:
              method: state
              numeric: true
              reverse: true
      - type: custom:vertical-stack-in-card
        cards:
          - type: custom:auto-entities
            filter:
              include:
                - options:
                    type: custom:entity-progress-card
                    card_mod:
                      style: |
                        ha-card {        
                          --ha-card-background: none;
                          --epb-progress-bar-background-color: {% set v = states(config.entity) | float(0) %}
                          {% if v < 70 %} rgba(123,193,60,0.1);
                          {% elif v < 200 %} rgba(193,187,60,0.1);
                          {% elif v < 700 %} rgba(255,165,0,0.1);
                          {% elif v < 1400 %} rgba(255,140,0,0.1);
                          {% else %} rgba(255,0,0,0.1);
                          {% endif %}
                          --epb-progress-size-l: 30px;
                          border-radius: 0px !important;
                          border: none;
                          position: relative;
                          padding: 0px !important;   /* Innenabstand entfernen */
                          margin: -1px 0px -20px 0px !important; /* vertikalen Abstand minimieren */
                        } 
                        .name, .value {
                        } 
                        .name-combined {
                          position: absolute;
                          top: 40%; /* Mitte der Karte */
                          margin-top: 0px; /* Feinjustierung nach unten, ins Zentrum des Balkens */
                          left: 0;
                          width: 100%;
                          font-weight: normal;
                          color: white;
                          z-index: 2;
                          pointer-events: none;
                          padding: 0 10px 0 8px;
                        } 
                        .progress-bar {
                          position: relative;
                          z-index: 0;
                          border-radius: 0px !important;
                        }
                        .name-custom-info {
                          float: right !important;
                          padding-right: 20px;
                        }
                    entity: this.entity_id
                    bar_size: large
                    name_info: >-
                      {{ states('this.entity_id') | float | round(1) }}
                      {{state_attr('this.entity_id','unit_of_measurement') }}
                    hide:
                      - icon
                      - value
                      - secondary_info
                    max_value: 1000
                    custom_theme:
                      - min: 0
                        max: 70
                        color: "#7bc13c"
                        opacity: 0.5
                      - min: 70
                        max: 200
                        color: "#c1bb3c"
                      - min: 200
                        max: 700
                        color: orange
                      - min: 700
                        max: 1400
                        color: darkorange
                      - min: 1400
                        max: 7000
                        color: "#ff0000"
                    icon_tap_action:
                      action: more-info
                  attributes:
                    device_class: power
              exclude:
                - options: {}
                  state: < 2
                - options: {}
                  state: unavailable
                - options: {}
                  entity_id: /batterie/
                - options: {}
                  entity_id: /total/
                - options: {}
                  entity_id: /shelly/
                - options: {}
                  entity_id: /now/
                - options: {}
                  entity_id: /open/
                - options: {}
                  entity_id: /hms/
                - options: {}
                  entity_id: /growatt/
                - options: {}
                  entity_id: /grid/
                - options: {}
                  entity_id: /settings/
                - options: {}
                  entity_id: /system/
                - options: {}
                  entity_id: /vebus/
                - options: {}
                  entity_id: /victron/
            card:
              square: false
              type: grid
              columns: 1
            show_empty: false
            card_param: cards
            sort:
              method: state
              numeric: true
              ignore_case: true
              reverse: true
        card_mod:
          style: |
            ha-card {    
              --grid-card-gap: 0px !important;
              box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                          13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
              border: none;  
              padding: 15px;
            }
  - type: grid
    cards:
      - type: custom:tabbed-card
        styles:
          margin-top: 16px !important;
          "--mdc-theme-primary": var(--primary-color)
          "--mdc-tab-text-label-color-default": grey
          "--mdc-typography-button-font-size": 14px
          "--mdc-typography-button-text-transform": capitalize
        tabs:
          - card:
              type: vertical-stack
              cards:
                - type: custom:floorplan-card
                  grid_options:
                    columns: full
                  config:
                    console_log_level: info
                    defaults:
                      hover_action: hover-info
                      tap_action: more-info
                    image: /local/energy-flow-card/energy-flow-card-small.svg
                    stylesheet: /local/energy-flow-card/energy-flow-card.css
                    rules:
                      - element: soc
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " %" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: batterie100
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          action: call-service
                          service: floorplan.style_set
                          service_data: >
                            ${parseFloat(entity.state) > 97 ? 'display:block' :
                            'display:none'}
                      - element: batterie80
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          action: call-service
                          service: floorplan.style_set
                          service_data: >
                            ${parseFloat(entity.state) > 80 ? 'display:block' :
                            'display:none'}
                      - element: batterie60
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          action: call-service
                          service: floorplan.style_set
                          service_data: >
                            ${parseFloat(entity.state) > 60 ? 'display:block' :
                            'display:none'}
                      - element: batterie40
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          action: call-service
                          service: floorplan.style_set
                          service_data: >
                            ${parseFloat(entity.state) > 40 ? 'display:block' :
                            'display:none'}
                      - element: batterie20
                        entity: sensor.victron_system_battery_soc
                        state_action:
                          action: call-service
                          service: floorplan.style_set
                          service_data: >
                            ${parseFloat(entity.state) > 1 ? 'display:block' :
                            'display:none'}
                      - element: dreieckbatteriein
                        entity: sensor.batterieladung_vr_watt
                        state_action:
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 30) ? 'display:block' :
                              'display:none'}
                      - element: dreieckbatterieout
                        entity: sensor.batterieentladung_vr_watt
                        state_action:
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0.1) ? 'opacity:1' :
                              'opacity:0'}
                      - element: batteriein
                        entity: sensor.victron_system_battery_power
                        state_action:
                          - service: floorplan.class_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 30) ? "batteriein" :
                              ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 30) ? "display:block" :
                              "display:none"}
                      - element: batterieoutani
                        entity: sensor.batterieentladung_vr_watt
                        state_action:
                          - service: floorplan.class_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > -10) ? "hausin" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 10) ? "display:block" :
                              "display:none"}
                      - element: solaroutani
                        entities:
                          - sensor.total_solar_power_kombiniert
                          - sensor.total_power_kombiniert
                        state_action:
                          - service: floorplan.class_set
                            service_data: |-
                              ${(
                                states['sensor.total_solar_power_kombiniert'].state !== undefined &&
                                states['sensor.total_power_kombiniert'].state !== undefined &&
                                parseFloat(states['sensor.total_solar_power_kombiniert'].state) >= parseFloat(states['sensor.total_power_kombiniert'].state)
                              ) ? "hausin" : ""}
                          - service: floorplan.style_set
                            service_data: |-
                              ${(
                                states['sensor.total_solar_power_kombiniert'].state !== undefined &&
                                states['sensor.total_power_kombiniert'].state !== undefined &&
                                parseFloat(states['sensor.total_solar_power_kombiniert'].state) >= parseFloat(states['sensor.total_power_kombiniert'].state)
                              ) ? "display:block" : "display:none"}
                      - element: hausin
                        entities:
                          - sensor.total_solar_power_kombiniert
                          - sensor.total_power_kombiniert
                        state_action:
                          - service: floorplan.class_set
                            service_data: |-
                              ${(
                                states['sensor.total_power_kombiniert'] &&
                                states['sensor.total_solar_power_kombiniert'] &&
                                parseFloat(states['sensor.total_power_kombiniert'].state) >= parseFloat(states['sensor.total_solar_power_kombiniert'].state)
                              ) ? "hausin" : ""}
                          - service: floorplan.style_set
                            service_data: |-
                              ${(
                                states['sensor.total_power_kombiniert'] &&
                                states['sensor.total_solar_power_kombiniert'] &&
                                parseFloat(states['sensor.total_power_kombiniert'].state) >= parseFloat(states['sensor.total_solar_power_kombiniert'].state)
                              ) ? "display:block" : "display:none"}
                      - element: solarin
                        entity: sensor.total_solar_power_kombiniert
                        state_action:
                          - service: floorplan.class_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 10) ? "solarin" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 10) ? "display:block" :
                              "display:none"}
                      - element: netzin
                        entity: sensor.total_power
                        state_action:
                          - service: floorplan.class_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 10) ? "netzin" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 10) ? "display:block" :
                              "display:none"}
                      - element: netzout
                        entity: sensor.total_power
                        state_action:
                          - service: floorplan.class_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) < 0) ? "netzout" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) < 0) ? "display:block" :
                              "display:none"}
                      - element: hausin
                        entity: sensor.batterieladung_vr_watt
                        state_action:
                          action: call-service
                          service: floorplan.class_set
                          service_data: >-
                            ${(parseFloat(entity.state) > 0) ? 'hausin
                            batteriebetrieb' : 'hausin'}    
                      - element: solarleistung
                        entity: sensor.erzeugzung_taglich_kombination_solaranlagen
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: solarleistungwatt
                        entity: sensor.total_solar_power_kombiniert
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " W" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: batterie
                        entity: sensor.batterieladung_vr_kwh_taglich_2
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0.1) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: batterieinwatt
                        entity: sensor.batterieladung_vr_watt
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 30) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " W" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 30) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: batterieout
                        entity: sensor.batterieentladung_vr_kwh_taglich
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0.1) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: batterieoutwatt
                        entity: sensor.batterieentladung_vr_watt
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " W" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: hausverbrauchwatt
                        entity: sensor.total_power_kombiniert
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " W" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: hausverbrauch
                        entity: sensor.verbrauch_taglich_nach_abzug
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: netzbezug
                        entity: sensor.stromverbrauch_taglich
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: netztbezugwatt
                        entity: sensor.total_power
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " W" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                      - element: netzeinspeisung
                        entity: sensor.solar_netzeinspeisung_kwh_taglich
                        state_action:
                          - service: floorplan.text_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0.06) ?
                              (Math.round(entity.state * 10) /
                              10).toString().replace(".", ",") + " kWh" : ""}
                          - service: floorplan.style_set
                            service_data: >-
                              ${(entity.state !== undefined &&
                              parseFloat(entity.state) > 0) ? 'display:block' :
                              'display:none'}
                          - service: floorplan.class_set
                            service_data:
                              class: static-value
                  card_mod:
                    style: |
                      ha-card {
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
                - layout: horizontal
                  height: 250
                  unit_prefix: k
                  round: 1
                  convert_units_to: ""
                  co2_intensity_entity: sensor.co2_signal_co2_intensity
                  gas_co2_intensity: 2351.6459999999997
                  min_box_size: 5
                  min_box_distance: 12
                  show_states: true
                  show_units: true
                  sections:
                    - entities:
                        - type: entity
                          children:
                            - entity_id: sensor.solar_netzeinspeisung_kwh
                              color: orange
                              name: Netzeinspeisung
                            - entity_id: sensor.batterieentladung_vr_kwh_taglich
                              color: green
                              name: Hausspeicher
                            - entity_id: total
                              color: orange
                          entity_id: sensor.growatt_todaygenerateenergy
                          name: Solar
                          color: green
                        - type: entity
                          children:
                            - entity_id: sensor.solar_netzeinspeisung_kwh
                              color: blue
                            - entity_id: total
                              color: red
                          entity_id: sensor.stromverbrauch_gesamt_kwh
                          name: Netzbezug
                          color: orange
                    - entities:
                        - type: remaining_parent_state
                          children:
                            - entity_id: werkstatt
                              color: cyan
                            - entity_id: garten
                              color: lime
                            - entity_id: wohnzimmer
                              color: pink
                            - entity_id: flur
                              color: magenta
                            - entity_id: unknown
                              color: gray
                          entity_id: total
                          name: Stromverbrauch
                          color: darkorange
                        - type: entity
                          children: []
                          entity_id: sensor.solar_netzeinspeisung_kwh
                          name: Netzeinspeisung
                          color: red
                        - type: entity
                          entity_id: sensor.batterieentladung_vr_kwh_taglich
                          name: Hausspeicher
                          color: green
                    - entities:
                        - type: remaining_child_state
                          children:
                            - entity_id: sensor.growlampe_umrechnung_kwh
                              color: brown
                            - entity_id: sensor.werkstattheizung_energiezahler
                              color: brown
                          entity_id: werkstatt
                          name: Werkstatt
                          color: red
                        - type: remaining_child_state
                          children:
                            - entity_id: sensor.skimmerpumpe_shelly_plug_switch_0_energy
                              color: lightblue
                            - entity_id: sensor.hauptpumpe_shelly_plug_switch_0_energy
                              color: lightblue
                            - entity_id: sensor.stromungspumpen_umrechnung_kwh
                              color: lightblue
                            - entity_id: sensor.wasserlauf_umrechnung_kwh
                              color: lightblue
                          entity_id: garten
                          name: Garten
                          color: steelblue
                        - type: remaining_child_state
                          children:
                            - entity_id: sensor.3d_drucker_summe_verbraucht
                              color: lightcoral
                            - entity_id: sensor.computer_summe_verbraucht
                              color: lightcoral
                            - entity_id: sensor.fernseher_plug_summe_verbraucht
                              color: lightcoral
                          entity_id: wohnzimmer
                          name: Wohnzimmer
                          color: lightcoral
                        - type: remaining_child_state
                          children:
                            - entity_id: sensor.trockner_summe_verbraucht_3
                              color: magenta
                            - entity_id: sensor.waschmaschine_summe_verbraucht_2
                              color: magenta
                          entity_id: flur
                          name: HWA
                          color: "#6d006b"
                        - type: remaining_parent_state
                          children: []
                          entity_id: unknown
                          name: Unbekannt
                          color: silver
                    - entities:
                        - type: entity
                          children: []
                          entity_id: sensor.growlampe_umrechnung_kwh
                          name: Growlampe kWh
                          color: brown
                        - type: entity
                          children: []
                          entity_id: sensor.werkstattheizung_energiezahler
                          name: Werkstatt Heizung
                          color: brown
                        - type: entity
                          children: []
                          entity_id: sensor.skimmerpumpe_shelly_plug_switch_0_energy
                          name: Skimmerpumpe
                          color: lightblue
                        - type: entity
                          children: []
                          entity_id: sensor.hauptpumpe_shelly_plug_switch_0_energy
                          name: Hauptpumpe
                          color: lightblue
                        - type: entity
                          children: []
                          entity_id: sensor.stromungspumpen_umrechnung_kwh
                          name: Strömungspumpen
                          color: lightblue
                        - type: entity
                          children: []
                          entity_id: sensor.wasserlauf_umrechnung_kwh
                          name: Wasserlauf
                          color: lightblue
                        - type: entity
                          children: []
                          entity_id: sensor.3d_drucker_summe_verbraucht
                          name: 3D-Drucker
                          color: lightcoral
                        - type: entity
                          children: []
                          entity_id: sensor.computer_summe_verbraucht
                          name: Computer
                          color: lightcoral
                        - type: entity
                          children: []
                          entity_id: sensor.fernseher_plug_summe_verbraucht
                          name: Fernseher
                          color: lightcoral
                        - type: entity
                          children: []
                          entity_id: sensor.trockner_summe_verbraucht_3
                          name: Trockner
                          color: magenta
                        - type: entity
                          children: []
                          entity_id: sensor.waschmaschine_summe_verbraucht_2
                          name: Waschmaschine
                          color: magenta
                      sort_by: state
                      sort_group_by_parent: true
                  type: custom:sankey-chart
                  min_state: 0
                  show_names: true
                  show_icons: false
                  wide: true
                  time_period_from: now/M
                  time_period_to: now
                  card_mod:
                    style: |
                      ha-card {    
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
                        border: none;
                      }
            attributes:
              label: Verbrauch Tag/Monat
              icon: mdi:home-lightning-bolt-outline
          - card:
              type: vertical-stack
              grid_options:
                columns: full
              cards:
                - type: custom:plotly-graph
                  defaults:
                    yaxes:
                      fixedrange: true
                      range:
                        - 0
                        - null
                  card_mod:
                    style: |
                      ha-card {
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
                        border: none;
                        margin-right: 10px !important;
                      }
                  entities:
                    - entity: sensor.victron_system_battery_soc
                      name: SOC
                      yaxis: y2
                      line:
                        width: 3
                        shape: spline
                        color: rgba(255, 255, 255, 0.3)
                      filters:
                        - map_y_numbers: Math.min(y, 100)
                    - entity: sensor.batterieentladung_vr_watt
                      name: Batterieentladung
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: "#6C9BC4"
                      filters:
                        - exponential_moving_average:
                            alpha: 0.7
                    - entity: sensor.total_solar_power_kombiniert
                      name: Solar Kombi
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: green
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                    - entity: sensor.total_power_nur_verbrauch
                      name: Netzbezug
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: orange
                      filters:
                        - exponential_moving_average:
                            alpha: 0.4
                    - entity: sensor.solar_einspeisung_normiert_positiver_wert
                      name: Netzeinspeisung
                      yaxis: y1
                      line:
                        shape: spline
                        color: red
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                    - entity: sensor.batterieladung_vr_watt
                      name: Batterieladung
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: "#AAE1FC"
                      filters:
                        - exponential_moving_average:
                            alpha: 0.8
                    - entity: sensor.power_production_now_3
                      name: Vorhersage akt.
                      yaxis: y1
                      line:
                        color: purple
                        dash: dot
                        width: 2
                  hours_to_show: current_day
                  refresh_interval: 120
                  min_y_axis: 0
                  fit_y_data: true
                  logarithmic_scale: true
                  max_y_axis: 3000
                  layout:
                    height: 290
                    plot_bgcolor: rgba(0,0,0,0)
                    margin:
                      t: 0
                      l: 45
                      r: 40
                    legend:
                      "y": -0.24
                      x: 0
                - type: custom:plotly-graph
                  defaults:
                    yaxes:
                      fixedrange: true
                    entity:
                      period: day
                      type: bar
                      statistic: state
                      texttemplate: "%{y:.1f}"
                      textposition: auto
                  entities:
                    - entity: sensor.erzeugzung_taglich_nach_abzug_einspeisung
                      name: Erzeugung
                      marker:
                        color: green
                        opacity: 1
                      textfont:
                        color: black
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(0,0,0)],
                              ys: [...ys, hass.states['sensor.erzeugzung_taglich_nach_abzug_einspeisung'].state],
                            })
                    - entity: sensor.batterieentladung_vr_kwh_taglich
                      name: Akku Entladung
                      marker:
                        color: "#6C9BC4"
                        opacity: 1
                      textfont:
                        color: black
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(0,0,0)],
                              ys: [...ys, hass.states['sensor.batterieentladung_vr_kwh_taglich'].state],
                            })
                    - entity: sensor.stromverbrauch_taglich
                      name: Bezug
                      marker:
                        color: darkorange
                        opacity: 1
                      textfont:
                        color: purple
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(0,0,0)],
                              ys: [...ys, hass.states['sensor.stromverbrauch_taglich'].state],
                            })
                    - entity: sensor.verbrauch_taglich_nach_abzug
                      name: Verbrauch
                      marker:
                        color: "#CAD97D"
                        opacity: 0.4
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(6,0,0)],
                              ys: [...ys, hass.states['sensor.verbrauch_taglich_nach_abzug'].state],
                            })
                      time_offset: 6h
                    - entity: sensor.batterieladung_vr_kwh_taglich_2
                      name: Akku Beladung
                      marker:
                        color: "#AAE1FC"
                        opacity: 0.4
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(6,0,0)],
                              ys: [...ys, hass.states['sensor.batterieladung_vr_kwh_taglich_2'].state],
                            })
                      time_offset: 6h
                    - entity: sensor.solar_netzeinspeisung_kwh_taglich
                      name: Netzeinspeisung
                      marker:
                        color: red
                        opacity: 0.4
                      textfont:
                        color: grey
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(6,0,0)],
                              ys: [...ys, hass.states['sensor.solar_netzeinspeisung_kwh_taglich'].state],
                            })
                      time_offset: 6h
                    - entity: sensor.energy_production_today_3
                      name: Prognose
                      marker:
                        color: "#45664a"
                        opacity: 0.2
                      textfont:
                        color: white
                      filters:
                        - filter: i>0 && i < xs.length - 1
                        - fn: |
                            ({ys,xs,hass}) => ({
                              xs: [...xs, new Date().setHours(-6,0,0)],
                              ys: [...ys, hass.states['sensor.energy_production_today_3'].state],
                            })
                      time_offset: "-6h"
                  layout:
                    plot_bgcolor: rgba(0,0,0,0)
                    barmode: stack
                    bargap: 0.05
                    barcornerradius: 2
                    uniformtext:
                      minsize: 10
                      mode: show
                    modebar:
                      orientation: v
                      remove: zoom
                    margin:
                      t: 5
                      l: 45
                      r: 20
                    height: 380
                    legend:
                      "y": -0.22
                      x: 0.1
                    xaxis:
                      rangeselector:
                        "y": 1.05
                        buttons:
                          - count: 1
                            step: day
                          - count: 7
                            step: day
                          - count: 10
                            step: day
                          - count: 30
                            step: day
                          - count: 6
                            step: month
                      gridcolor: rgba(238,235,235,0.3)
                      autorange: true
                      showgrid: true
                    yaxis:
                      visible: true
                      autorange: true
                  hours_to_show: 7d
                  refresh_interval: 360
                  card_mod:
                    style: |
                      ha-card {
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
                        border: none;   
                        margin-top: 3px;
                        margin-bottom: 0px;
                      }
            attributes:
              label: Aufteilung Heute
              icon: mdi:solar-power
          - card:
              type: custom:layout-card
              layout_type: custom:grid-layout
              layout:
                grid-template-columns: 55% 45%
                grid-template-rows: auto
                mediaquery:
                  "(max-width: 1000px)":
                    grid-template-columns: 100%
                    grid-template-rows: auto
              cards:
                - type: custom:power-flow-card-plus
                  entities:
                    battery:
                      entity:
                        consumption: sensor.batterieentladung_vr_watt
                        production: sensor.batterieladung_vr_watt
                      state_of_charge: sensor.victron_system_battery_soc
                      state_of_charge_unit_white_space: false
                      show_state_of_charge: true
                      color_state_of_charge_value: true
                    solar:
                      entity: sensor.total_solar_power_kombiniert
                      display_zero_state: true
                      secondary_info: {}
                      color_value: true
                      color_icon: false
                      invert_state: false
                      use_metadata: false
                      color:
                        - 11
                        - 157
                        - 67
                    individual:
                      - entity: sensor.poolverbrauch_summe_watt
                        secondary_info: {}
                        icon: mdi:pool
                        name: Pool Summe
                        color:
                          - 42
                          - 101
                          - 156
                      - entity: sensor.growlampe_leistung
                        secondary_info: {}
                        name: GrowLed
                        calculate_flow_rate: false
                        color_value: false
                        color_icon: false
                        icon: mdi:ceiling-light
                        unit_white_space: true
                        inverted_animation: false
                        show_direction: false
                        use_metadata: false
                      - entity: sensor.innenlufter_shellyplug_switch_0_power
                        secondary_info: {}
                        name: Lüfter
                        icon: mdi:fan
                        color:
                          - 115
                          - 156
                          - 217
                      - entity: sensor.werkstattheizung_leistung
                        secondary_info: {}
                        color:
                          - 98
                          - 9
                          - 9
                        display_zero: false
                        name: Werkstatt Hzg.
                        display_zero_state: false
                        color_value: false
                        color_icon: false
                        icon: mdi:heating-coil
                        use_metadata: false
                        show_direction: false
                    home:
                      secondary_info: {}
                      circle_animation: true
                      override_state: true
                      subtract_individual: true
                      color_icon: true
                      color_value: true
                    grid:
                      secondary_info: {}
                      icon: ""
                      color:
                        consumption:
                          - 211
                          - 102
                          - 13
                        production:
                          - 182
                          - 12
                          - 12
                      color_value: true
                      invert_state: false
                      entity:
                        consumption: sensor.total_power_nur_verbrauch
                        production: sensor.solar_einspeisung_normiert_positiver_wert
                      color_circle: true
                      color_icon: true
                  clickable_entities: true
                  display_zero_lines:
                    mode: transparency
                    transparency: 50
                    grey_color:
                      - 189
                      - 189
                      - 189
                  use_new_flow_rate_model: true
                  w_decimals: 0
                  kw_decimals: 1
                  min_flow_rate: 0.75
                  max_flow_rate: 6
                  max_expected_power: 3000
                  min_expected_power: 0.01
                  watt_threshold: 1000
                  transparency_zero_lines: 0
                  card_mod:
                    style: |
                      ha-card {
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
                - type: custom:power-flow-card-plus
                  entities:
                    solar:
                      display_zero_state: true
                      secondary_info: {}
                      color_value: true
                      color_icon: false
                      invert_state: false
                      use_metadata: false
                      color:
                        - 11
                        - 157
                        - 67
                    individual:
                      - entity: sensor.wasserlauf_leistung
                        secondary_info: {}
                        icon: mdi:chart-waterfall
                        name: Wasserlauf
                        color:
                          - 42
                          - 101
                          - 156
                      - entity: sensor.stromungspumpen_leistung
                        secondary_info: {}
                        name: Strömungspumpen
                        calculate_flow_rate: false
                        color_value: false
                        color_icon: true
                        icon: mdi:air-filter
                        unit_white_space: true
                        inverted_animation: false
                        show_direction: false
                        use_metadata: false
                      - entity: sensor.skimmerpumpe_shelly_plug_switch_0_power
                        secondary_info: {}
                        name: Skimmer
                        icon: mdi:waves-arrow-right
                        color:
                          - 47
                          - 90
                          - 156
                      - entity: sensor.poollicht_leistung
                        secondary_info: {}
                        color:
                          - 239
                          - 200
                          - 6
                        display_zero: false
                        name: Poollicht
                        display_zero_state: false
                        color_value: false
                        color_icon: false
                        icon: mdi:light-flood-down
                        use_metadata: false
                        show_direction: false
                    home:
                      secondary_info:
                        icon: ""
                        color_value: false
                      circle_animation: false
                      override_state: true
                      subtract_individual: false
                      color_icon: battery
                      icon: mdi:waves-arrow-left
                      entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                      name: Hauptpumpe
                      use_metadata: false
                    grid:
                      secondary_info: {}
                      icon: ""
                      color:
                        consumption:
                          - 211
                          - 102
                          - 13
                        production:
                          - 182
                          - 12
                          - 12
                      color_value: true
                      invert_state: false
                      entity: sensor.poolverbrauch_summe_watt
                      use_metadata: false
                      display_state: one_way_no_zero
                      color_icon: true
                      color_circle: true
                    clickable_entities: true
                    display_zero_lines:
                      mode: transparency
                      transparency: 50
                      grey_color:
                        - 189
                        - 189
                        - 189
                    use_new_flow_rate_model: true
                    w_decimals: 0
                    kw_decimals: 1
                    min_flow_rate: 0.75
                    max_flow_rate: 6
                    max_expected_power: 3000
                    min_expected_power: 0.01
                    watt_threshold: 1000
                    transparency_zero_lines: 0
                  card_mod:
                    style: |
                      ha-card {
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
                - type: custom:plotly-graph
                  defaults:
                    yaxes:
                      fixedrange: true
                      range:
                        - 0
                        - null
                  card_mod:
                    style: |
                      ha-card {
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
                        border: none;
                        margin-right: 10px !important;
                      }
                  entities:
                    - entity: sensor.total_solar_power_kombiniert
                      name: Gesamt
                      yaxis: y1
                      line:
                        color: steelblue
                        width: 2
                    - entity: sensor.growatt_outpowerwatt
                      name: PV Dach
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: green
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                    - entity: sensor.opendtu_a8067c_ac_power
                      name: BKW S/O
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: orange
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                    - entity: sensor.batterie_neo800_total_ausgangsleistung
                      name: BKW Pool
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: yellow
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                    - entity: sensor.stream_mikro_wechselrichter_1180_power_ac
                      name: BKW Nord
                      yaxis: y1
                      fill: tozeroy
                      line:
                        shape: spline
                        color: purple
                      filters:
                        - exponential_moving_average:
                            alpha: 0.05
                  hours_to_show: 7
                  refresh_interval: 120
                  min_y_axis: 0
                  fit_y_data: true
                  logarithmic_scale: true
                  max_y_axis: 3000
                  layout:
                    plot_bgcolor: rgba(0,0,0,0)
                    margin:
                      t: 0
                      l: 45
                      r: 40
                    legend:
                      "y": -0.24
                      x: 0
                - type: custom:power-flow-card-plus
                  entities:
                    individual:
                      - entity: sensor.opendtu_a8067c_ac_power
                        secondary_info: {}
                        name: BKW Süd Ost
                        calculate_flow_rate: true
                        color_value: false
                        color: orange
                        icon: mdi:solar-panel
                        unit_white_space: true
                        inverted_animation: false
                        show_direction: false
                        use_metadata: false
                      - entity: sensor.batterie_neo800_total_ausgangsleistung
                        secondary_info: {}
                        name: BKW Pool
                        icon: mdi:solar-panel
                        color: yellow
                      - entity: sensor.stream_mikro_wechselrichter_1180_power_ac
                        secondary_info: {}
                        icon: mdi:solar-panel
                        name: BKW Nord
                        color: purple
                    home:
                      secondary_info:
                        icon: ""
                        color_value: false
                      circle_animation: true
                      override_state: true
                      subtract_individual: false
                      color_icon: true
                      icon: mdi:solar-panel-large
                      entity: sensor.growatt_outpowerwatt
                      name: Solar Dach
                      use_metadata: false
                    grid:
                      secondary_info: {}
                      icon: mdi:solar-power
                      name: Solar In
                      color:
                        consumption: green
                        production:
                          - 182
                          - 12
                          - 12
                      color_value: true
                      invert_state: false
                      entity: sensor.total_solar_power_kombiniert
                      use_metadata: false
                      display_state: one_way_no_zero
                      color_icon: true
                      color_circle: true
                    clickable_entities: true
                    display_zero_lines:
                      mode: transparency
                      transparency: 50
                      grey_color:
                        - 189
                        - 189
                        - 189
                    use_new_flow_rate_model: true
                    w_decimals: 1
                    kw_decimals: 0
                    min_flow_rate: 0.75
                    max_flow_rate: 6
                    max_expected_power: 3000
                    min_expected_power: 0.01
                    watt_threshold: 500
                    transparency_zero_lines: 0
                  card_mod:
                    style: |
                      ha-card {
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
            attributes:
              label: Leistung Akt.
              icon: mdi:solar-power-variant
          - card:
              type: vertical-stack
              cards:
                - type: custom:stack-in-card
                  card_mod:
                    style: |
                      ha-card {
                        padding: 0px;
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
                  cards:
                    - type: horizontal-stack
                      cards:
                        - type: energy-date-selection
                          card_mod:
                            style: |
                              ha-card {
                                border: 0px;
                                background: transparent !important;                        
                              }
                    - type: custom:layout-card
                      layout_type: custom:grid-layout
                      layout:
                        grid-template-columns: 70% 30%
                        grid-template-rows: auto
                        mediaquery:
                          "(max-width: 1000px)":
                            grid-template-columns: 100%
                            grid-template-rows: auto
                      cards:
                        - type: vertical-stack
                          cards:
                            - type: energy-usage-graph
                              card_mod:
                                style: |
                                  ha-card  {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
                            - type: energy-solar-graph
                              card_mod:
                                style: |
                                  ha-card  {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
                        - type: vertical-stack
                          cards:
                            - type: energy-distribution
                              card_mod:
                                style: |
                                  ha-card {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
                            - type: custom:venus-os-dashboard
                              param:
                                boxCol1: 2
                                boxCol3: 2
                                boxCol2: 1
                              theme: dark
                              devices:
                                1-1:
                                  icon: mdi:transmission-tower
                                  name: Netz
                                  entity: sensor.total_power
                                  anchors: R-1
                                  link:
                                    "1":
                                      start: R-1
                                      end: 2-1_L-1
                                      entity: sensor.total_power
                                  graph: true
                                1-2:
                                  icon: mdi:battery-charging
                                  name: Batterie
                                  entity: sensor.victron_system_battery_soc
                                  anchors: R-1
                                  link:
                                    "1":
                                      start: R-1
                                      end: 2-1_B-1
                                      entity: sensor.victron_system_battery_power
                                  gauge: true
                                  graph: true
                                2-1:
                                  icon: mdi:cellphone-charging
                                  name: Multiplus II
                                  entity: sensor.victron_system_battery_state
                                  anchors: L-1, B-2, R-1
                                3-1:
                                  icon: mdi:home-lightning-bolt
                                  name: AC-Haus
                                  entity: sensor.total_power_kombiniert
                                  anchors: L-1
                                  link:
                                    "1":
                                      start: L-1
                                      end: 2-1_R-1
                                      entity: sensor.total_power_kombiniert
                                      inv: true
                                3-2:
                                  icon: mdi:weather-sunny
                                  name: Solar
                                  entity: sensor.total_solar_power_kombiniert
                                  anchors: L-1
                                  link:
                                    "1":
                                      start: L-1
                                      end: 2-1_B-2
                                      entity: sensor.total_solar_power_kombiniert
                                      inv: true
                                  graph: true
                              styles:
                                header: auto
                                footer: auto
                              grid_options:
                                columns: full
                              card_mod:
                                style: |
                                  ha-card {
                                    box-shadow: nonoe !important;
                                    background-color: transparent;
                                  --box-background-color: rgb(31,42,60,0.1);
                                  --box-shadow-color: #38619b;
                                  --anchor-color: green;
                                  --line-color: orange;
                                  }
                                  .dashboard {
                                    background: none;
                                  }
                                  .boxSensor1 {
                                    padding-top: 5px !important;
                                  }
                                  .ball {
                                    r: 6 !important;
                                    fill: steelblue !important; 
                                  }
                                  .graph path {
                                    stroke: green !important;
                                  }
                                  .boxFooter {
                                    position: absolute;
                                    display: flex;
                                    flex-direction: column;
                                    flex-wrap: wrap;
                                    bottom: 2px;
                                    width: 100%;
                                    font-size: 0.8em;
                                    gap: 10% !important;
                                    z-index: 1000;
                                  }
                                  .headerEntity {
                                    font-size: 0.8em;
                                    line-height: 1.1em;
                                  }
            attributes:
              label: History Strom
              icon: mdi:history
          - card:
              type: vertical-stack
              cards:
                - type: custom:stack-in-card
                  card_mod:
                    style: |
                      ha-card {
                        padding: 0px;
                        border: none;
                        box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                                    13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;            
                      }
                  cards:
                    - type: horizontal-stack
                      cards:
                        - type: energy-date-selection
                          card_mod:
                            style: |
                              ha-card {
                                border: 0px;
                                background: transparent !important;                        
                              }
                    - type: custom:layout-card
                      layout_type: custom:grid-layout
                      layout:
                        grid-template-columns: 70% 30%
                        grid-template-rows: auto
                        mediaquery:
                          "(max-width: 1000px)":
                            grid-template-columns: 100%
                            grid-template-rows: auto
                      cards:
                        - type: horizontal-stack
                          cards:
                            - type: energy-devices-graph
                              card_mod:
                                style: |
                                  ha-card {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
                        - type: vertical-stack
                          cards:
                            - type: energy-grid-neutrality-gauge
                              card_mod:
                                style: |
                                  ha-card {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
                                  ha-svg-icon {
                                    visibility: hidden; 
                                  }
                            - type: energy-distribution
                              card_mod:
                                style: |
                                  ha-card {
                                    margin-top: -20px;
                                    background: transparent !important;
                                  }
            attributes:
              label: History Geräte
              icon: mdi:history
        grid_options:
          columns: full
      - type: custom:stack-in-card
        grid_options:
          columns: full
        card_mod:
          style: |
            ha-card {
              box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                          13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
              border: none;   
              padding: 0px;
              height: 65%;
            }
        cards:
          - type: horizontal-stack
            cards:
              - type: custom:bar-card
                entities:
                  - entity: sensor.total_power_kombiniert
                    icon: " "
                    name: Verbrauch
                    color: darkorange
                height: 60px
                width: 70%
                direction: up
                max: 3500
                card_mod:
                  style: |
                    :host {
                      --stack-card-margin: 0px;
                      --ha-card-border-radius: 5px;
                      --ha-card-border-width: 0px;
                    }
                    ha-card {              
                      background: none !important; 
                      border: none;      
                      box-shadow: none;
                      padding-top: 0px;
                      padding-bottm: 0px;
                      margin: 5px -30px 0 -30px;
                      height: 65%;
                    }
              - type: custom:bar-card
                entities:
                  - entity: sensor.total_power
                    icon: " "
                    name: Netz
                    color: red
                height: 60px
                width: 70%
                direction: up
                max: 3500
                card_mod:
                  style: |
                    :host {
                      --stack-card-margin: 0px;
                      --ha-card-border-radius: 5px;
                      --ha-card-border-width: 0px;
                    }
                    ha-card {           
                      background: none !important; 
                      border: none;     
                      box-shadow: none;
                      padding-top: 0px;
                      padding-bottm: 0px;
                      margin: 5px -30px 0 -30px;
                      height: 65%;
                    }
              - type: custom:bar-card
                entities:
                  - entity: sensor.total_solar_power_kombiniert
                    icon: " "
                    name: Solar
                    color: green
                height: 60px
                width: 70%
                direction: up
                max: 3500
                card_mod:
                  style: |
                    :host {
                      --stack-card-margin: 0px;
                      --ha-card-border-radius: 5px;
                      --ha-card-border-width: 0px;
                    }
                    ha-card {           
                      background: none !important; 
                      border: none;     
                      box-shadow: none;
                      padding-top: 0px;
                      padding-bottm: 0px;
                      margin: 5px -30px 0 -30px;
                      height: 65%;
                    }
              - type: custom:bar-card
                entities:
                  - entity: sensor.victron_system_battery_power
                    icon: " "
                    name: Batterie
                    color: "#6C9BC4"
                height: 60px
                width: 70%
                direction: up
                max: 3500
                card_mod:
                  style: |
                    :host {
                      --stack-card-margin: 0px;
                      --ha-card-border-radius: 5px;
                      --ha-card-border-width: 0px;
                    }
                    ha-card {           
                      background: none !important; 
                      border: none;     
                      box-shadow: none;
                      padding-top: 0px;
                      padding-bottm: 0px;
                      margin: 5px -30px 0 -30px;
                      height: 65%;
                    }
    column_span: 2
  - type: grid
    cards:
      - type: heading
        heading: Detailansicht Growatt Server
        heading_style: title
      - show_name: true
        show_icon: true
        type: button
        tap_action:
          action: toggle
        entity: input_boolean.show_iframe
        grid_options:
          columns: full
          rows: 0.5
        show_state: true
        name: History Growatt Server
        icon_height: 1px
        card_mod:
          style: |
            ha-card {
              box-shadow: rgba(0, 0, 0, 0.4) 0px 2px 4px, rgba(0, 0, 0, 0.3) 0px 7px
                          13px -3px, rgba(0, 0, 0, 0.2) 0px -3px 0px inset !important;
              border: none;
            }
      - type: conditional
        conditions:
          - entity: input_boolean.show_iframe
            state: "on"
        card:
          type: iframe
          url: >-
            https://server.growatt.com/singlePage/toSinglePage/3437E9933DE49807D6A0AFBAA9EBC9DC084636BDC0EA6DD6E70F1F0A5B8629ABF4E55BC22EE5BDFDB830ED7032DC0EAB
          aspect_ratio: 45%
        grid_options:
          columns: full
          rows: 10
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: "#batterie"
            show_header: false
            bg_color: rgb(43 53 71)
            shadow_opacity: 0
            width_desktop: 650px
            margin_top_desktop: 10vh
          - type: custom:stack-in-card
            card_mod:
              style: |
                ha-card {
                  border: none !important;
                  border-radius: 0px !important;
                  background: none;
                }
            cards:
              - type: picture-elements
                card_mod:
                  style: |
                    ha-card {
                      border: none !important;
                      border-radius: 0px !important;
                      width: 75% !important;
                      margin: 0 auto;    
                    }          
                    :host {
                      font-size: 0em !important;
                      --label-badge-red: steelblue !important;
                      --label-badge-background-color: transparent !important;
                    }
                elements:
                  - type: state-badge
                    entity: sensor.victron_system_battery_voltage
                    style:
                      top: 23%
                      left: 34%
                      "--ha-label-badge-font-size": 14px
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    title: Volt
                  - type: state-badge
                    entity: sensor.victron_vebus_battery_temperature_238
                    style:
                      top: 28%
                      left: 50%
                      "--ha-label-badge-font-size": 14px
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    title: Volt
                  - type: state-badge
                    entity: sensor.batterie_vr_endladezeit
                    style:
                      top: 33%
                      left: 66%
                      "--ha-label-badge-font-size": 16px
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                    title: Temp
                image: local/bilder/hausspeicher.png
              - type: vertical-stack
                cards:
                  - type: custom:bar-card
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          margin-top: -20px;
                          --primary-color: #7bc13c !important;  
                        }
                        #states {
                          padding: 16px !important;
                        }  
                        bar-card-currentbar {
                          border-radius: 3px !important; 
                            
                          {% if states['switch.acpowervonbatterie'].state == 'on' %}
                          background: linear-gradient(270deg, red, orange, green);
                          background-size: 300% 100%;
                          animation: gradientShiftNormal 3s linear infinite;
                          clip-path: inset(0 calc(100% - var(--bar-percent)) 0 0);

                          {% elif states['switch.acpowerzubatterie'].state == 'on' %}
                          background: linear-gradient(270deg, red, orange, green);
                          background-size: 300% 100%;
                          animation: gradientShiftReverse 3s linear infinite;
                          clip-path: inset(0 calc(100% - var(--bar-percent)) 0 0);

                          {% else %}
                          background: linear-gradient(to right, darkorange 15%, orange 25%, yellow 50%, green 100%);
                          clip-path: inset(0 calc(100% - var(--bar-percent)) 0 0);
                          {% endif %}
                        }                  
                        bar-card-backgroundbar { 
                          border-radius: 3px !important; 
                          background: linear-gradient(to right, darkorange 15%, orange 25%, yellow 50%, green 100%);
                          clip-path: inset(0 calc(100% - var(--bar-percent)) 0 0);
                        }
                        @keyframes gradientShiftNormal {
                          0% { background-position: 0% 50%; }
                          100% { background-position: 100% 50%; }
                        }
                        @keyframes gradientShiftReverse {
                          100% { background-position: 0% 50%; }
                          0% { background-position: 100% 50%; }
                        }
                    name: Hausspeicher
                    positions:
                      name: inside
                      value: inside
                      indicator: "off"
                      icon: "off"
                    unit_of_measurement: "%"
                    max: 100
                    height: 25px
                    severity:
                      - color: "#ff0000"
                        from: 0
                        to: 25
                      - color: darkorange
                        from: 25
                        to: 50
                      - color: orange
                        from: 50
                        to: 75
                      - color: "#7bc13c"
                        from: 75
                        to: 100
                    entities:
                      - entity: sensor.victron_system_battery_soc
              - type: horizontal-stack
                cards:
                  - type: custom:bar-card
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                        }
                        #states {
                          padding: 0 16px 0 16px !important;
                        }               
                        bar-card-backgroundbar { 
                          border-radius: 3px !important;  
                        }
                        bar-card-currentbar {
                          border-radius: 3px !important;  
                        }
                    name: Total Eingang
                    positions:
                      name: inside
                      value: inside
                      indicator: "off"
                      icon: "off"
                    unit_of_measurement: W
                    max: 100
                    height: 20px
                    severity:
                      - color: grey
                        from: 0
                        to: 50
                      - color: darkorange
                        from: 50
                        to: 100
                      - color: orange
                        from: 100
                        to: 300
                      - color: "#7bc13c"
                        from: 300
                        to: 1000
                      - color: green
                        from: 1000
                        to: 2000
                    entities:
                      - entity: sensor.batterieladung_vr_watt
                  - type: custom:bar-card
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                        }
                        #states {
                          padding: 0 16px 10px 16px !important;
                        }               
                        bar-card-backgroundbar { 
                          border-radius: 3px !important;  
                        }
                        bar-card-currentbar {
                          border-radius: 3px !important;  
                        }
                    name: Total Augang
                    positions:
                      name: inside
                      value: inside
                      indicator: "off"
                      icon: "off"
                    unit_of_measurement: W
                    max: 300
                    height: 20px
                    severity:
                      - color: grey
                        from: 0
                        to: 10
                      - color: "#7bc13c"
                        from: 10
                        to: 250
                      - color: orange
                        from: 250
                        to: 400
                      - color: darkorange
                        from: 400
                        to: 600
                      - color: red
                        from: 600
                        to: 1000
                    entities:
                      - entity: sensor.batterieentladung_vr_watt
              - type: horizontal-stack
                cards:
                  - type: custom:button-card
                    entity: input_select.victron_multiplus_modus
                    name: Ein
                    icon: mdi:power-on
                    color_type: card
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      target:
                        entity_id: input_select.victron_multiplus_modus
                      data:
                        option: Ein
                    state:
                      - value: Ein
                        color: green
                    card_mod:
                      style: |
                        ha-card {
                          background: rgb(128,128,128, 0.1) !important;
                          border: 1px solid grey !important;
                          border-radius: 8px !important;
                          width: 80%
                        }
                  - type: custom:button-card
                    entity: input_select.victron_multiplus_modus
                    name: Aus
                    icon: mdi:power-off
                    color_type: card
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      target:
                        entity_id: input_select.victron_multiplus_modus
                      data:
                        option: Aus
                    state:
                      - value: Aus
                        color: orange
                    card_mod:
                      style: |
                        ha-card {
                          background: rgb(128,128,128, 0.1) !important;
                          border: 1px solid grey !important;
                          border-radius: 8px !important;
                          width: 80%
                        }
                  - type: custom:button-card
                    entity: input_select.victron_multiplus_modus
                    name: Laden
                    icon: mdi:battery-charging
                    color_type: card
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      target:
                        entity_id: input_select.victron_multiplus_modus
                      data:
                        option: Laden
                    state:
                      - value: Laden
                        color: green
                    card_mod:
                      style: |
                        ha-card {
                          background: rgb(128,128,128, 0.1) !important;
                          border: 1px solid grey !important;
                          border-radius: 8px !important;
                          width: 80%
                        }     
                  - type: custom:button-card
                    entity: input_select.victron_multiplus_modus
                    name: Wechselrichter
                    icon: mdi:power-plug-battery-outline
                    color_type: card
                    tap_action:
                      action: call-service
                      service: input_select.select_option
                      target:
                        entity_id: input_select.victron_multiplus_modus
                      data:
                        option: Wechselrichter
                    state:
                      - value: Wechselrichter
                        color: green
                    card_mod:
                      style: |
                        ha-card {
                          background: rgb(128,128,128, 0.1) !important;
                          border: 1px solid grey !important;
                          border-radius: 8px !important;
                          width: 80%
                        }   
              - type: horizontal-stack
                cards:
                  - type: entities
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          margin-top: -5px;
                          border-radius: 0px !important;
                        }
                    entities:
                      - entity: sensor.batterieentladung_vr_umrechnung_kwh_gesamt
                        name: Total out
                        icon: mdi:home-lightning-bolt-outline
                      - entity: sensor.batterieladung_vr_umrechnung_kwh_gesamt
                        name: Total in
                        icon: mdi:solar-power-variant
                    theme: grey-icon
                    state_color: false
                    show_header_toggle: false
                  - type: entities
                    card_mod:
                      style: |
                        ha-card {
                          border: none !important;
                          margin-top: -5px;
                          border-radius: 0px !important;
                        }
                    entities:
                      - entity: sensor.batterieentladung_vr_kwh_taglich
                        name: Heute out
                        icon: mdi:home-lightning-bolt-outline
                      - entity: sensor.batterieladung_vr_kwh_taglich_2
                        name: Heute in
                        icon: mdi:solar-power-variant
                    theme: grey-icon
                    state_color: false
                    show_header_toggle: false
          - type: history-graph
            card_mod:
              style: |
                ha-card {
                  background: none !important;
                  border: none !important;
                  margin-top: -25px;
                  border-radius: 0px !important;
                }
            entities:
              - entity: sensor.victron_system_battery_state
                name: " "
            hours_to_show: 24
          - type: horizontal-stack
            cards:
              - type: custom:bar-card
                name: Output
                direction: up
                positions:
                  name: inside
                  value: outside
                  indicator: "off"
                  icon: "off"
                height: 125
                width: 80%
                unit_of_measurement: W
                max: 2000
                entities:
                  - entity: sensor.batterieentladung_vr_watt
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -20px;
                      background: none !important;
                      border: none;   
                    }
                    bar-card-backgroundbar { 
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 15%, yellow 40%, green 100%);
                    }
                    bar-card-currentbar {
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 15%, yellow 40%, green 100%);
                      clip-path: inset(calc(100% - var(--bar-percent)) 0 0 0);
                    }
              - type: custom:bar-card
                name: Input
                direction: up
                positions:
                  name: inside
                  value: outside
                  indicator: "off"
                  icon: "off"
                height: 125
                width: 80%
                unit_of_measurement: W
                max: 2000
                entities:
                  - entity: sensor.batterieladung_vr_watt
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -20px;
                      background: none !important;
                      border: none;   
                    }
                    bar-card-backgroundbar { 
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 15%, yellow 40%, green 100%);
                    }
                    bar-card-currentbar {
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 15%, yellow 40%, green 100%);
                      clip-path: inset(calc(100% - var(--bar-percent)) 0 0 0);
                    }
              - type: custom:bar-card
                name: Amp
                direction: up
                positions:
                  name: inside
                  value: outside
                  indicator: "off"
                  icon: "off"
                height: 125
                width: 80%
                unit_of_measurement: A
                max: 40
                entities:
                  - entity: sensor.victron_vebus_battery_current_238
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -20px;
                      background: none !important;
                      border: none;   
                    }
                    bar-card-backgroundbar { 
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 400%, yellow 10%, green 5%);
                    }
                    bar-card-currentbar {
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 400%, yellow 10%, green 5%);
                      clip-path: inset(calc(100% - var(--bar-percent)) 0 0 0);
                    }
              - type: custom:bar-card
                name: Volt
                direction: up
                positions:
                  name: inside
                  value: outside
                  indicator: "off"
                  icon: "off"
                height: 125
                width: 80%
                unit_of_measurement: V
                max: 58
                entities:
                  - entity: sensor.victron_vebus_battery_voltage_238
                card_mod:
                  style: |
                    ha-card {
                      margin-top: -20px;
                      background: none !important;
                      border: none;   
                    }
                    bar-card-backgroundbar { 
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, steelblue 35%, green 70%, orange 100%);
                    }
                    bar-card-currentbar {
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, darkorange 35%, yellow 60%, green 100%);
                      clip-path: inset(calc(100% - var(--bar-percent)) 0 0 0);
                    }
              - type: custom:bar-card
                name: Temp
                direction: up
                positions:
                  name: inside
                  value: outside
                  indicator: "off"
                  icon: "off"
                height: 125
                width: 80%
                unit_of_measurement: °C
                max: 70
                entities:
                  - entity: sensor.victron_vebus_battery_temperature_238
                card_mod:
                  style: |
                    ha-card {              
                      margin-top: -20px;
                      background: none !important;
                      border: none;   
                    }
                    bar-card-backgroundbar { 
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, green 15%, yellow 40%, darkorange 75%, red 100%);
                    }
                    bar-card-currentbar {
                      border-radius: 0px !important;  
                      background: linear-gradient(to top, steelblue 15%, green 40%, darkorange 75%, red 100%);
                      clip-path: inset(calc(100% - var(--bar-percent)) 0 0 0);
                    }
      - type: conditional
        conditions:
          - condition: state
            entity: input_boolean.button_background_dashboard
            state: "on"
        card:
          type: iframe
          url: /local/particles/background/index.html
          aspect_ratio: 50%
          card_mod:
            style: |
              ha-card {
                border: none !important;
                border-radius: 0px !important;
                background: none !important;
                box-shadow: none !important;
                z-index: -1;
                position: fixed;
                top:0;
                left:0;
                width:100%;
                height:100%;
                opacity:0.2;
              }
      - type: custom:bubble-card
        styles: |
          .bubble-icon {
            --mdc-icon-size: 30px !important;
            height: 35px;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
            padding-right: 10px; 
            color: var(--primary-color);
          } 
          * { 
            font-size: 10px !important;
            border: none !important;
            border-radius: 0px !important;
            background: rgba(0,0,0,0) !important;
          }
        card_type: horizontal-buttons-stack
        auto_order: false
        1_name: ""
        1_icon: mdi:keyboard-backspace
        1_link: /dashboard-test/home
        2_link: /dashboard-test/heizung
        2_icon: mdi:heating-coil
        3_link: /dashboard-test/licht
        3_icon: mdi:lamps
        4_link: /dashboard-test/garten
        4_icon: mdi:pool
        5_link: /dashboard-test/wetter
        5_icon: mdi:weather-partly-cloudy
        6_link: /dashboard-test/solar
        6_icon: mdi:home-lightning-bolt-outline
        card_mod:
          style: |
            ha-card {
              border: none !important;
              border-radius: 0px !important;
              background: none !important;
              box-shadow: none !important;
              padding: 0px; 
              z-index: 2;
              position: fixed;
              margin: 0 !important;
              bottom: 0;
            }
    column_span: 3
background:
  opacity: 100
  alignment: center
  size: cover
  repeat: no-repeat
  attachment: fixed
  image: /api/image/serve/a0db373e66314ef8086b0b96661bab80/original
cards: []
max_columns: 3
