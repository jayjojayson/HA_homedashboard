type: custom:vertical-stack-in-card
cards:
  - type: horizontal-stack
    cards:
      - type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          grid-template-columns: 37% 31% 32%
          grid-template-rows: auto
          mediaquery:
            "(max-width: 1000px)":
              grid-template-columns: 100%
              grid-template-rows: auto
        cards:
          - type: custom:floorplan-card
            config:
              console_log_level: info
              defaults:
                hover_action: hover-info
                tap_action: more-info
              image: /local/pool-card/pool-card.svg
              stylesheet: /local/pool-card/pool-card.css
              rules:
                - element: wasserlauf
                  entity: switch.wasserlauf_steckdose_1
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: entitystate-${entity.state}
                - element: abfluss
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"flussH\" : \"\"}"
                - element: abfluss2
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"flussH\" : \"\"}"
                - element: abfluss3
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"flussV\" : \"\"}"
                - element: abfluss4
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"zuflussV\" : \"\"}"
                - element: abfluss5
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"zuflussV\" : \"\"}"
                - element: abfluss6
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"zuflussV\" : \"\"}"
                - element: abfluss7
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"zuflussH\" : \"\"}"
                - element: abfluss7-4
                  entity: switch.skimmerpumpe_shelly_plug_switch_0
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state === \"on\") ? \"zuflussH\" : \"\"}"
                - element: zufluss
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"zuflussH\" : \"\"}"
                - element: zufluss2
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"zuflussH\" : \"\"}"
                - element: zufluss3
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"flussV\" : \"\"}"
                - element: zufluss4
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"flussH\" : \"\"}"
                - element: zufluss5
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"flussV\" : \"\"}"
                - element: zufluss6
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(Number(entity.state) > 5) ? \"zuflussV\" : \"\"}"
                - element: zufluss_strom
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state > \"10\") ? \"flussH\" : \"\"}"
                - element: zufluss_strom2
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state > \"10\") ? \"flussH\" : \"\"}"
                - element: rad
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state > \"10\") ? \"rad\" : \"\"}"
                - element: rad2
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    action: call-service
                    service: floorplan.class_set
                    service_data: "${(entity.state > \"10\") ? \"rad2\" : \"\"}"
                - element: hauptpumpe
                  entity: sensor.hauptpumpe_shelly_plug_switch_0_power
                  state_action:
                    - service: floorplan.text_set
                      service_data: >-
                        ${(entity.state !== undefined) ?
                        Math.round(entity.state) + "W" : " "}
                    - service: floorplan.class_set
                      service_data:
                        class: static-value
                - element: skimmer
                  entity: sensor.skimmerpumpe_shelly_plug_switch_0_power
                  state_action:
                    - service: floorplan.text_set
                      service_data: >-
                        ${(entity.state !== undefined) ?
                        Math.round(entity.state) + "W" : " "}
                    - service: floorplan.class_set
                      service_data:
                        class: static-value
                - element: wasspumpe_leistung
                  entity: sensor.wasserlauf_leistung
                  state_action:
                    - service: floorplan.text_set
                      service_data: >-
                        ${(entity.state > 5) ? Math.round(entity.state) + "W" :
                        " "}
                    - service: floorplan.class_set
                      service_data:
                        class: static-value
                - element: stromungspumpe
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    - service: floorplan.text_set
                      service_data: >-
                        ${(entity.state > 5) ? Math.round(entity.state) / 2 +
                        "W" : " "}
                    - service: floorplan.class_set
                      service_data:
                        class: static-value
                - element: stromungspumpe2
                  entity: sensor.stromungspumpen_leistung
                  state_action:
                    - service: floorplan.text_set
                      service_data: >-
                        ${(entity.state > 5) ? Math.round(entity.state) / 2 +
                        "W" : " "}
                    - service: floorplan.class_set
                      service_data:
                        class: static-value
            card_mod:
              style: |
                ha-card {
                  background: none !important;   
                  box-shadow: none !important;
                  border: none;
                }
          - type: entities
            entities:
              - entity: switch.hauptpumpe_shelly_plug_switch_0
                name: Hauptpumpe
                icon: mdi:waves-arrow-left
                secondary_info: last-changed
              - entity: switch.skimmerpumpe_shelly_plug_switch_0
                name: Skimmer
                secondary_info: last-changed
                icon: mdi:waves-arrow-right
              - entity: switch.stromungspumpen_steckdose_1
                name: "Str√∂mungspumpen "
                icon: mdi:air-filter
                secondary_info: last-changed
              - entity: switch.wasserlauf_steckdose_1
                name: Wasserlauf
                icon: mdi:chart-waterfall
                secondary_info: last-changed
              - entity: switch.poollicht_steckdose_1
                icon: mdi:light-flood-down
                secondary_info: last-changed
                name: Poollicht
              - entity: switch.pool_roboter_smart_plug
                name: Roboter laden
                secondary_info: last-changed
            theme: grey-icon
            state_color: true
            card_mod:
              style: |
                ha-card {
                  background: none !important;   
                  box-shadow: none !important;
                  border: none;
                  margin-top:10px;
                  padding-right: 30px;
                }
          - camera_view: auto
            type: picture-glance
            title: " "
            entities:
              - entity: select.poolkamera_ptz_voreinstellung
                icon: mdi:pool
                tap_action:
                  action: call-service
                  service: select.select_option
                  service_data:
                    entity_id: select.poolkamera_ptz_voreinstellung
                    option: Poolansicht
                icon_tap_action:
                  action: call-service
                  service: select.select_option
                  service_data:
                    entity_id: select.poolkamera_ptz_voreinstellung
                    option: Poolansicht
              - entity: select.poolkamera_ptz_voreinstellung
                icon: mdi:store-search
                tap_action:
                  action: call-service
                  service: select.select_option
                  service_data:
                    entity_id: select.poolkamera_ptz_voreinstellung
                    option: Terrasse
                icon_tap_action:
                  action: call-service
                  service: select.select_option
                  service_data:
                    entity_id: select.poolkamera_ptz_voreinstellung
                    option: Terrasse
            camera_image: camera.poolkamera_klar
            card_mod:
              style: |
                ha-card {
                  border: none !important;   
                  box-shadow: none !important;
                }
                .box {
                  position: absolute;
                  left: 0px;
                  right: 0px;
                  bottom: 0px;
                  background-color: var(--ha-picture-card-background-color,rgba(0,0,0,.2)) !important;
                  padding: 0px 0px 5px 0px !important;
                  display: flex;
                  justify-content: flex-center !important;
                  flex-direction: row;
                }
